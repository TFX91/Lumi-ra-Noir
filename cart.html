<!DOCTYPE html>
<html lang="sk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lumièra Noir – Košík</title>

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600&family=Inter:wght@300;400&display=swap" rel="stylesheet">
<link rel="stylesheet" href="css/style.css">

<style>
body {
  margin:0;
  font-family:'Inter',sans-serif;
  overflow-x:hidden;
  background: linear-gradient(to bottom, #1b0033, #05000a);
  color:#fff;
  scroll-behavior: smooth;
  padding-top:80px;
}

/* BACKGROUND EFFECTS */
.galaxy { position: fixed; inset:0; background:url('https://raw.githubusercontent.com/JulianLaval/canvas-particle-network/master/img/demo-bg.jpg') center/cover no-repeat; opacity:.12; z-index:-2; }
.city { position: fixed; bottom:0; width:100%; height:220px; background:url('https://i.ibb.co/ZYW3VTp/cityscape.png') bottom center/cover no-repeat; opacity:.10; z-index:-1; }

/* NAV */
nav .menu a.active { color:#b36bff; text-shadow:0 0 12px #b36bff; }

/* CART */
.cart-wrapper { margin-top:140px; max-width:1100px; margin-inline:auto; padding:40px; }
.cart-title { text-align:center; font-size:3rem; text-shadow:0 0 22px #b36bff; margin-bottom:30px; }
.cart-list { display:flex; flex-direction:column; gap:22px; }
.cart-item { display:grid; grid-template-columns:120px 1fr auto; gap:24px; padding:20px; border-radius:28px; background:rgba(255,255,255,.03); backdrop-filter:blur(14px); }
.cart-item img { width:120px; height:120px; object-fit:cover; border-radius:20px; }
.cart-price { align-self:center; font-size:1.4rem; }
.cart-footer { margin-top:40px; display:flex; justify-content:space-between; align-items:center; }
.cart-continue { padding:16px 46px; border-radius:30px; border:2px solid #b36bff; background:none; color:#b36bff; cursor:pointer; transition:.3s; }
.cart-continue:hover { background:#b36bff; color:#000; }

/* CHECKOUT OVERLAY */
.checkout-overlay { position:fixed; inset:0; background:rgba(0,0,0,.5); backdrop-filter:blur(12px); display:flex; justify-content:flex-end; opacity:0; pointer-events:none; transition:.4s; z-index:300; }
.checkout-overlay.active { opacity:1; pointer-events:auto; }
.checkout-panel { width:460px; height:100%; padding:32px; background:rgba(0,0,0,.35); backdrop-filter:blur(24px); display:flex; flex-direction:column; transform:translateX(100%); transition:.5s; }
.checkout-overlay.active .checkout-panel { transform:translateX(0); }
.checkout-panel h3 { letter-spacing:.25em; color:#c9b46d; }
.checkout-body { margin-top:20px; display:flex; flex-direction:column; gap:14px; }
.checkout-body input, .checkout-body textarea, .checkout-body select { padding:12px 16px; border-radius:16px; border:none; background:rgba(0,0,0,.3); color:#fff; }
.checkout-body input::placeholder, .checkout-body textarea::placeholder { color:rgba(255,255,255,.6); }
.checkout-body small { opacity:.6; font-size:.75rem; }
.gdpr { display:flex; gap:10px; font-size:.75rem; opacity:.75; align-items:center; }
.gdpr a { color:#c9b46d; }
.error { color:#ff6b6b; font-size:.75rem; display:none; transition:.3s; }
.summary { padding:12px; background:rgba(255,255,255,.05); border-radius:16px; font-size:.85rem; white-space:pre-line; }

/* SUBMIT */
.checkout-confirm { margin-top:auto; padding:14px; border-radius:18px; border:none; background:rgba(179,107,255,.45); color:#fff; cursor:pointer; }
.checkout-confirm:hover { background:rgba(179,107,255,.65); }

/* SUCCESS OVERLAY */
.success-overlay { position:fixed; inset:0; background:rgba(0,0,0,.8); display:flex; justify-content:center; align-items:center; opacity:0; pointer-events:none; transition:.5s; z-index:400; flex-direction:column; text-align:center; color:#fff; }
.success-overlay.active { opacity:1; pointer-events:auto; }
.success-box { background:rgba(255,255,255,.05); backdrop-filter:blur(24px); padding:40px; border-radius:28px; animation:popin 0.6s ease forwards; max-width:400px; }
.success-box h2 { font-size:2rem; color:#c9b46d; margin-bottom:20px; text-shadow:0 0 18px #b36bff; }
.success-box p { margin-bottom:24px; opacity:.85; }
.success-box button { padding:14px 32px; border-radius:28px; border:none; background:#b36bff; color:#000; font-weight:600; cursor:pointer; transition:.4s; }
.success-box button:hover { background:#fff; color:#000; }

@keyframes popin {0%{transform:scale(0.5);opacity:0}60%{transform:scale(1.05);opacity:1}100%{transform:scale(1);opacity:1}}
</style>
</head>
<body>

<canvas id="bgParticles"></canvas>
<div class="galaxy"></div>
<div class="city"></div>

<nav>
  <div class="nav-inner">
    <div class="logo">Lumièra Noir</div>
    <div class="menu">
      <a href="index.html">Domov</a>
      <a href="collection.html">Kolekcia</a>
      <a href="vision.html">Vízia</a>
      <a href="private-order.html">Privátna objednávka</a>
      <a href="about.html">O nás</a>
      <a href="cart.html" class="active">Košík</a>
    </div>
  </div>
</nav>

<section class="cart-wrapper">
  <h1 class="cart-title">Váš Košík</h1>
  <div class="cart-list" id="cartList"></div>
  <div class="cart-footer">
    <div id="cartTotal"></div>
    <button class="cart-continue" id="openCheckout">Pokračovať</button>
  </div>
</section>

<!-- Checkout Form -->
<div class="checkout-overlay" id="overlay">
  <div class="checkout-panel">
    <h3>KONTAKTNÝ FORMULÁR</h3>
    <div class="checkout-body">
      <input id="name" placeholder="Meno *">
      <input id="surname" placeholder="Priezvisko *">
      <input id="email" placeholder="Email *">
      <input id="phone" placeholder="Telefón">
      <select id="contactPref">
        <option value="">Preferovaný kontakt</option>
        <option>Email</option>
        <option>Telefón</option>
      </select>
      <textarea id="note" placeholder="Poznámka alebo špeciálna požiadavka"></textarea>
      <div class="summary" id="orderSummary" readonly></div>
      <div class="gdpr">
        <input type="checkbox" id="gdpr">
        <label>Súhlasím so spracovaním osobných údajov podľa <a href="https://eur-lex.europa.eu/eli/reg/2016/679/oj" target="_blank">GDPR (EU)</a> *</label>
      </div>
      <div class="error" id="error">Vyplňte povinné polia a potvrďte GDPR.</div>
    </div>
    <button class="checkout-confirm" id="send">Odoslať objednávku</button>
  </div>
</div>

<!-- Success Overlay -->
<div class="success-overlay" id="successOverlay">
  <div class="success-box">
    <h2>✔ Objednávka odoslaná!</h2>
    <p>Vaša objednávka bola úspešne prijatá. Ďakujeme za dôveru a exkluzívny výber v Lumièra Noir.</p>
    <button id="backCollection">Späť na kolekciu</button>
    <button id="backHome" style="margin-top:10px;background:#c9b46d;color:#000;">Domov</button>
  </div>
</div>

<script src="js3/app.js"></script>
<script src="js3/effects/effects.ambient.js"></script>

<script>
document.addEventListener("DOMContentLoaded", ()=>{
  JS3.effects.ambient.init();

  const cart=JSON.parse(localStorage.getItem("ln_cart")||"[]");
  const list=document.getElementById("cartList");
  const cartTotal=document.getElementById("cartTotal");
  const overlay=document.getElementById("overlay");
  const openCheckout=document.getElementById("openCheckout");
  const send=document.getElementById("send");
  const name=document.getElementById("name");
  const surname=document.getElementById("surname");
  const email=document.getElementById("email");
  const phone=document.getElementById("phone");
  const contactPref=document.getElementById("contactPref");
  const note=document.getElementById("note");
  const gdpr=document.getElementById("gdpr");
  const error=document.getElementById("error");
  const orderSummary=document.getElementById("orderSummary");
  const successOverlay=document.getElementById("successOverlay");
  const backCollection=document.getElementById("backCollection");
  const backHome=document.getElementById("backHome");

  let total=0;
  list.innerHTML="";
  cart.forEach(i=>{
    total+=i.price;
    const div=document.createElement("div");
    div.className="cart-item";
    div.innerHTML=`<img src="${i.image}"><div><h4>${i.name}</h4><p>${i.description||""}</p></div><div class="cart-price">${i.price} €</div>`;
    list.appendChild(div);
  });
  cartTotal.textContent="Celkom: "+total+" €";

  function updateSummary(){
    let text="";
    cart.forEach(i=>text+=`${i.name} – ${i.price}€\n`);
    text+="Celkom: "+total+" €";
    orderSummary.innerText=text;
  }

  openCheckout.onclick=()=>{overlay.classList.add("active"); updateSummary();}
  overlay.onclick=e=>{if(e.target===overlay) overlay.classList.remove("active");}

  send.onclick=()=>{
    const emailRegex=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if(!name.value||!surname.value||!email.value||!gdpr.checked||!emailRegex.test(email.value)){
      error.style.display="block"; return;
    }
    error.style.display="none";

    const order={
      name:name.value, surname:surname.value, email:email.value, phone:phone.value,
      contactPref:contactPref.value, note:note.value, cart:cart, total:total,
      created:new Date().toLocaleString()
    };
    localStorage.setItem("ln_checkout",JSON.stringify(order));
    localStorage.removeItem("ln_cart");

    overlay.classList.remove("active");
    successOverlay.classList.add("active");
  };

  backCollection.onclick=()=>{window.location.href='collection.html';}
  backHome.onclick=()=>{window.location.href='index.html';}
  successOverlay.onclick=e=>{if(e.target===successOverlay) successOverlay.classList.remove("active");}
});
</script>

</body>
</html>
